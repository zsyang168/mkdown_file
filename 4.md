#  第4章　用Python分析网络流量

## 本章简介

### 定位IP流量的地理位置

### 发现恶意分布式拒绝服务(DDos)工具包

### 发现伪装网络扫描

### 分析风暴(Storm)僵尸网络中使用的Fast-Flux和Conficker蠕虫中使用的Domain-Flux

### 理解TCP序号预测攻击

### 生成数据包愚弄入侵检测系统(IDS)


## 引言　＂极光＂行动以及为什么明显的迹象会被忽视

2010年1月14日，美国政府获悉一起多路协同、老练且持久的网络攻击，攻击目标为谷歌、Adobe及其他30多家世界财富100强企业（Binde, McRee, &O'Connor, 2011)。
在这次被称为“极光”行动（该名称源于一台被黑的计算机上发现的文件夹名字）的攻击中，使用了一个之前从未被使用过的新型漏洞利用代码，尽管微软先前知道这个系统
漏洞，但他们错误地以为没有其他人知道它，因此也就没有要检测类似攻击的机制。

在实施攻击的过程中，攻击者首先会向被攻击者发送一封带有指向台湾某个含有恶意JavaScrip代码的网站链接的电子邮件（Binde, McRee, &O'Connor, 2011)。当用户
单击这个链接时，就会下载一个回到一台位于中国大陆的命令行控制服务器的恶意软件（Zetter, 2010)。之后，攻击者就能利用新获得的访问权限寻找存储在被黑的系统中
他们所关心的信息。

攻击很明显的出现了但在长达数月的时间里却未被检测出来，而是成功的渗透进了许多家世界100强企业的源码仓库，甚至是基本的网络检测软件也能识别这次行为。为
什么一个位于美国的世界100强公司有这么多员工连接上中国台湾的某个特定的网站之后，紧接着又去连接位于中国大陆的某个特定服务器呢？一个可视化的地图显示用户连
接台湾和中国具有显著的频率可以允许网络管理员调查这次攻击，并在相关信息泄露之前切断它。
	在下面的内容中，我们运用Python分析多种不同类型的的攻击行为，以便快速解析出使用了大量不同数据点的攻击。

## 4.1 IP流量何去何从？－－用Python回答

### 使用PyGeoIP关联IP地址的物理位置

### 使用Dpkt解析包

### 使用Python画谷歌地图

## 4.2 ＂匿名者＂真能匿名吗？分析LOIC流量


## 4.3 H.D.Moore是如何解决五角大楼的麻烦的


## 4.4 ＂风暴＂(Storm)的fast-flux和Conficker的domain-flux


## 4.5 Kevin Mitnick和TCP序列预测


## 4.6 使用Scapy愚弄入侵检测系统


## 本章小结





